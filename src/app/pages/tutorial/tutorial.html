<ion-header class="ion-no-border">
  <ion-toolbar class="toolbar-logo">
    <!-- Logo centrato -->
    <div class="toolbar-center">
      <img src="assets/img/logo_comune.png" alt="Comune di Castelraimondo" />
    </div>

    <!-- Pulsante Skip -->
    <ion-buttons slot="end">
      <ion-button color="primary" (click)="startApp()" [hidden]="!showSkip">Skip</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<!-- NB: #pageContent serve al fix offsetHeight (gestito nel TS) -->
<ion-content #pageContent fullscreen="true" class="kiosk">
  <div class="viewport">
    <!-- Info -->
    <div class="info-kiosk">
      <div class="clock">üïí {{ currentTime }}</div>
      <div class="date">üìÖ {{ currentDate }}</div>
      <div class="weather" *ngIf="weather">
        üå§Ô∏è {{ weather.name }} - {{ weather.weather[0].description }} ({{ weather.main.temp }}¬∞C)
      </div>
    </div>

    <!-- Slides -->
    <div class="slide-container">
      <!-- SLIDE 1: Carosello A3 (scrollabile + autoplay da TS) -->
      <section class="slide slide-ads">
        <div class="ads-carousel">
          <div
            #adsTrack
            class="ads-track"
            (scroll)="onAdsScroll()"
            (pointerdown)="pauseAdsCarousel(true); $event.stopPropagation()"
            (pointerup)="resumeAdsCarousel()"
            (touchstart)="$event.stopPropagation()"
            (touchend)="resumeAdsCarousel()"
          >
            <figure class="ads-item" *ngFor="let img of adsImages; let i = index" (click)="openImageFull(img)">
              <img [src]="img" (error)="removeBrokenAd(i)" alt="Promozione" loading="eager" />
            </figure>
          </div>

          <div class="ads-dots" *ngIf="adsImages.length > 1">
            <span
              *ngFor="let _ of adsImages; let i = index"
              class="dot"
              [class.active]="i === adsIndex"
              (click)="goToAd(i)">
            </span>
          </div>
        </div>
      </section>

      <!-- SLIDE 2: Info (card + testo giustificato + loghi) -->
      <section class="slide slide-info">
        <div class="info-card">
          <img src="assets/img/ica-slidebox-img-1.png" class="slide-image" alt="Logo" />

          <h2 class="slide-title tight">Welcome to <b>CASTELRAIMONDO</b></h2>

          <p class="slide-text">
            Centro commerciale Naturale "<b>Il Cassero 2.0</b>" √® il progetto di
            riqualificazione e valorizzazione territoriale realizzato da un' aggregazione di 10 imprese locali che, con
            una comunione di intenti, hanno dato vita ad una serie di interventi volti al potenziamento del decoro delle
            proprie attivit√† e ad un intervento condiviso, che si √® tradotto in un totem multimediale per la promozione
            delle imprese e del territorio di Castelraimondo. Un progetto che premia la sinergia e il fare sistema.
          </p>

          <div class="partners-logos">
            <img src="assets/img/loghi_enti.png" alt="Enti e Partner" loading="lazy" />
          </div>
        </div>
      </section>

      <!-- SLIDE 3: Video + CTA in basso -->
      <section #videoSection class="slide slide-video" [class.active]="isVideoActive">
        <video
          #slideVideo
          class="hero-video"
          preload="none"
          [muted]="muted"
          playsinline
          [attr.poster]="'assets/img/video-poster.jpg'"
          [attr.webkit-playsinline]="true">
          <!-- src impostata da TS quando la slide √® attiva -->
        </video>

        <!-- Hamburger in alto a sinistra -->
        <div class="video-chrome">
          <ion-button fill="clear" size="large" (click)="toggleMenu()" aria-label="Apri menu">
            <ion-icon [ios]="'menu-outline'" [md]="'menu-outline'"></ion-icon>
          </ion-button>
        </div>

        <!-- CTA in basso alla slide (ancorati al bottom) -->
        <div class="video-cta">
          <ion-button size="large" (click)="unmuteAndPlay()" *ngIf="showUnmuteBtn">üîä Audio ON</ion-button>
          <ion-button
            class="cta"
            size="large"
            color="primary"
            routerLink="/app/tabs/schedule"
            routerDirection="root">
            INIZIA ORA
          </ion-button>
        </div>
      </section>
    </div>
  </div>

  <!-- Modal immagine -->
  <ion-modal
    [isOpen]="isImageModalOpen"
    (didDismiss)="closeImageFull()"
    class="image-modal"
    backdropDismiss="true">
    <ng-template>
      <div class="image-modal-wrapper" (click)="closeImageFull()">
        <img [src]="modalImageSrc" alt="Anteprima" />
      </div>
    </ng-template>
  </ion-modal>
</ion-content>

<!-- Footer PBC + Endri -->
<ion-footer class="pbc-footer">
  <div class="pbc-wrap">
    <img src="assets/img/pbc.png"   alt="PBC - Grafica sito"  class="brand-logo" />
    <img src="assets/img/endri.png" alt="Endri - Grafica sito" class="brand-logo" />
  </div>
</ion-footer>
